q6.4 <- summarise(q6.1, mv=kerker(Event, Record))
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
kerker <- function(x, y) {
tmp <- y[y < q6.3[q6.3$Event == x[1], 2]]
return(length(tmp))
}
q6.4 <- summarise(q6.1, mv=kerker(Event, Record))
q6.4
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
kerker <- function(x, y) {
print(x[1])
print(q6.3[q6.3$Event == x[1], 2])
tmp <- y[y < q6.3[q6.3$Event == x[1], 2]]
return(length(tmp))
}
q6.4 <- summarise(q6.1, mv=kerker(Event, Record))
q6.4
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
kerker <- function(x, y) {
print(x[1])
print(x[2])
print(q6.3[q6.3$Event == x[1], 2])
tmp <- y[y < q6.3[q6.3$Event == x[1], 2]]
return(length(tmp))
}
q6.4 <- summarise(q6.1, mv=kerker(Event, Record))
q6.4
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
kerker <- function(x, y) {
print(x[1])
print(x[2])
print(q6.3[q6.3$Event == x[1], 2])
tmp <- y[y < q6.3[q6.3$Event == x[1], 2]]
return(length(tmp))
}
q6.4 <- summarise(q6.1, mv=kerker(Event, Record))
q6.4
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
kerker <- function(x, y) {
print(x[1])
print(q6.3)
print(q6.3[q6.3$Event == x[1], 2])
tmp <- y[y < q6.3[q6.3$Event == x[1], 2]]
return(length(tmp))
}
q6.4 <- summarise(q6.1, mv=kerker(Event, Record))
q6.4
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
kerker <- function(x, y) {
print(x[1])
print(y[1])
print(q6.3)
print(q6.3[q6.3$Event == x[1], 2])
tmp <- y[y < q6.3[q6.3$Event == x[1], 2]]
return(length(tmp))
}
q6.4 <- summarise(q6.1, mv=kerker(Event, Record))
q6.4
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
kerker <- function(x, y) {
print(x[1])
print(x[2])
print(y[1])
print(y[2])
print(q6.3)
print(q6.3[q6.3$Event == x[1], 2])
tmp <- y[y < q6.3[q6.3$Event == x[1], 2]]
return(length(tmp))
}
q6.4 <- summarise(q6.1, mv=kerker(Event, Record))
q6.4
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
kerker <- function(x, y) {
print(x[1])
print(x[2])
print(y[1])
print(y[2])
print(q6.3[q6.3$Event == x[1],])
tmp <- y[y < q6.3[q6.3$Event == x[1], 2]]
return(length(tmp))
}
q6.4 <- summarise(q6.1, mv=kerker(Event, Record))
q6.4
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
kerker <- function(x, y) {
print(x[1])
print(x[2])
print(y[1])
print(y[2])
print(q6.3[q6.3$Event == x[1],]$avg)
tmp <- y[y < q6.3[q6.3$Event == x[1], 2]]
return(length(tmp))
}
q6.4 <- summarise(q6.1, mv=kerker(Event, Record))
q6.4
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
kerker <- function(x, y) {
print(x[1])
print(x[2])
print(y[1])
print(y[2])
print(q6.3[q6.3$Event == x[1],]$avg)
tmp <- y[y < q6.3[q6.3$Event == x[1],]$avg]
print(tmp)
return(length(tmp))
}
q6.4 <- summarise(q6.1, mv=kerker(Event, Record))
q6.4
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
kerker <- function(x, y) {
print(x[1])
print(x[2])
print(y[1])
print(y[2])
print(q6.3[q6.3$Event == x[1],]$avg)
tmp <- y[y < q6.3[q6.3$Event == x[1],]$avg]
print(tmp)
return(length(tmp))
}
q6.4 <- summarise(q6.1, n=kerker(Event, Record))
q6.4
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
kerker <- function(x, y, z) {
print(z)
print(x[1])
print(x[2])
print(y[1])
print(y[2])
print(q6.3[q6.3$Event == x[1],]$avg)
tmp <- y[y < q6.3[q6.3$Event == x[1],]$avg]
print(tmp)
return(length(tmp))
}
q6.4 <- summarise(q6.1, n=kerker(Event, Record, mean(Record)))
q6.4
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
q6.1[q6.1$Record < 10]
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
q6.1[q6.1$Record < 10,]
kerker <- function(x, y, z) {
print(z)
print(x[1])
print(x[2])
print(y[1])
print(y[2])
print(q6.3[q6.3$Event == x[1],]$avg)
tmp <- y[y < q6.3[q6.3$Event == x[1],]$avg]
print(tmp)
return(length(tmp))
}
q6.4 <- summarise(q6.1, n=kerker(Event, Record, mean(Record)))
q6.4
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
q6.1[q6.1$Record < q6.3[q6.3$Event==q6.1$Event,2],]
kerker <- function(x, y, z) {
print(z)
print(x[1])
print(x[2])
print(y[1])
print(y[2])
print(q6.3[q6.3$Event == x[1],]$avg)
tmp <- y[y < q6.3[q6.3$Event == x[1],]$avg]
print(tmp)
return(length(tmp))
}
q6.4 <- summarise(q6.1, n=kerker(Event, Record, mean(Record)))
q6.4
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
q6.1[q6.1$Record < q6.3[which(q6.3$Event==q6.1$Event),2],]
kerker <- function(x, y, z) {
print(z)
print(x[1])
print(x[2])
print(y[1])
print(y[2])
print(q6.3[q6.3$Event == x[1],]$avg)
tmp <- y[y < q6.3[q6.3$Event == x[1],]$avg]
print(tmp)
return(length(tmp))
}
q6.4 <- summarise(q6.1, n=kerker(Event, Record, mean(Record)))
q6.4
help("which")
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
q6.1[q6.1$Record < q6.3[which(q6.3==q6.1$Event),2],]
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
which(q6.3==q6.1$Event)
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
q6.1[q6.1$Record > q6.3[which(q6.3[,1]==q6.1$Event),]$avg, ]
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
q6.4 <- mutate(q6.2, avg=mean(q6.2))
q6.4
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, avg=mean(Record))
q6.3
q6.4 <- mutate(q6.2, avg=mean(Record))
q6.4
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, Avg=mean(Record))
q6.3
q6.4 <- mutate(q6.2, Avg=mean(Record))
q6.4
q6.5 <- filter(q6.4, Record > Avg)
q6.5
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
q6.3 <- summarise(q6.2, Avg=mean(Record))
q6.3
q6.4 <- mutate(q6.2, Avg=mean(Record))
q6.4
q6.5 <- filter(q6.4, Record > Avg)
q6.5
q6.6 <- summarise(q6.5, n=n())
q6.6
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
summarise(q6.2, Avg=mean(Record))
q6.4 <- mutate(q6.2, Avg=mean(Record))
q6.5 <- filter(q6.4, Record > Avg)
summarise(q6.5, n=n())
q7.m.1 <- filter(worldrecords, Event=="Mens 100m")
q7.m.2 <- group_by(q7.m.1, Athlete)
q7.m.3 <- summarize(q7.m.2, NumberOfRecords=n())
filter(q7.m.3, NumberOfRecords == max(NumberOfRecords))
q7.w.1 <- filter(worldrecords, Event=="Womens 100m")
q7.w.2 <- group_by(q7.w.1, Athlete)
q7.w.3 <- summarize(q7.w.2, NumberOfRecords=n())
q7.w.4 <- arrange(q7.w.3, NumberOfRecords)
tail(q7.w.4, n=1)
q7.m.1 <- filter(worldrecords, Event=="Mens 100m")
q7.m.2 <- group_by(q7.m.1, Athlete)
q7.m.2
q7.m.3 <- summarize(q7.m.2, NumberOfRecords=n())
filter(q7.m.3, NumberOfRecords == max(NumberOfRecords))
q7.w.1 <- filter(worldrecords, Event=="Womens 100m")
q7.w.2 <- group_by(q7.w.1, Athlete)
q7.w.2
q7.w.3 <- summarize(q7.w.2, NumberOfRecords=n())
filter(q7.w.3, NumberOfRecords == max(NumberOfRecords))
q7.m.1 <- filter(worldrecords, Event=="Mens 100m")
q7.m.2 <- group_by(q7.m.1, Athlete)
q7.m.3 <- summarize(q7.m.2, NumberOfRecords=n())
filter(q7.m.3, NumberOfRecords == max(NumberOfRecords))
q7.w.1 <- filter(worldrecords, Event=="Womens 100m")
q7.w.2 <- group_by(q7.w.1, Athlete)
q7.w.3 <- summarize(q7.w.2, NumberOfRecords=n())
filter(q7.w.3, NumberOfRecords == max(NumberOfRecords))
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
summarise(q6.2, Avg=mean(Record))
q6.4 <- mutate(q6.2, Avg=mean(Record))
q6.5 <- filter(q6.4, Record > Avg)
summarise(q6.5, n=n())
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
summarise(q6.2, Avg=mean(Record))
q6.4 <- mutate(q6.2, Avg=mean(Record))
q6.5 <- filter(q6.4, Record > Avg)
summarise(q6.5, Athletes=n())
q8.1 <- filter(worldrecords, Event=="Mens 100m")
q8.2 <- group_by(q8.1, Nationality)
q8.3 <- summarize(q8.2, NumberOfRecords=n())
filter(q8.3, NumberOfRecords == max(NumberOfRecords))
q9.1 <- group_by(worldrecords, Event)
summarise(q9.1, Athletes=n_distinct(Athlete))
q10.1 <- group_by(worldrecords, Nationality)
q10.2 <- summarize(q10.1, NumberOfRecords=n())
q10.2
filter(q10.2, NumberOfRecords = max(NumberOfRecords))
q10.1 <- group_by(worldrecords, Nationality)
q10.2 <- summarize(q10.1, NumberOfRecords=n())
q10.2
filter(q10.2, NumberOfRecords == max(NumberOfRecords))
library(dplyr)
setwd("/Users/ChiYuChen/Data Analysis, Intro/Assignment 4")
worldrecords <- read.csv("WorldRecords.csv")
worldrecords
q1.1 <- group_by(worldrecords, Event)
nrow(summarise(q1.1))
q2.1 <- filter(worldrecords, Event=="Mens 100m", Athlete=="Usain Bolt")
q2.1[1,]$Year
class(worldrecords$Type)
q4 <- filter(worldrecords, Event=="Mens Shotput" | Event=="Womens Shotput")
q4
library(ggplot2)
q5.m <- filter(q4, Event=="Mens Shotput")
ggplot(q5.m, aes(x = Year, y = Record))+ geom_point() + labs(title="Mens Shotput")
q5.w <- filter(q4, Event=="Womens Shotput")
ggplot(q5.w, aes(x = Year, y = Record))+ geom_point() + labs(title="Womens Shotput")
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
summarise(q6.2, Avg=mean(Record))
q6.4 <- mutate(q6.2, Avg=mean(Record))
q6.5 <- filter(q6.4, Record > Avg)
summarise(q6.5, Athletes=n())
q7.m.1 <- filter(worldrecords, Event=="Mens 100m")
q7.m.2 <- group_by(q7.m.1, Athlete)
q7.m.3 <- summarize(q7.m.2, NumberOfRecords=n())
filter(q7.m.3, NumberOfRecords == max(NumberOfRecords))
q7.w.1 <- filter(worldrecords, Event=="Womens 100m")
q7.w.2 <- group_by(q7.w.1, Athlete)
q7.w.3 <- summarize(q7.w.2, NumberOfRecords=n())
filter(q7.w.3, NumberOfRecords == max(NumberOfRecords))
q8.1 <- filter(worldrecords, Event=="Mens 100m")
q8.2 <- group_by(q8.1, Nationality)
q8.3 <- summarize(q8.2, NumberOfRecords=n())
filter(q8.3, NumberOfRecords == max(NumberOfRecords))
q9.1 <- group_by(worldrecords, Event)
summarise(q9.1, Athletes=n_distinct(Athlete))
q10.1 <- group_by(worldrecords, Nationality)
q10.2 <- summarize(q10.1, NumberOfRecords=n())
filter(q10.2, NumberOfRecords == max(NumberOfRecords))
library(dplyr)
setwd("/Users/ChiYuChen/Data Analysis, Intro/Assignment 4")
worldrecords <- read.csv("WorldRecords.csv")
library(dplyr)
setwd("/Users/ChiYuChen/Data Analysis, Intro/Assignment 4")
worldrecords <- read.csv("WorldRecords.csv")
q1.1 <- group_by(worldrecords, Event)
nrow(summarise(q1.1))
q2.1 <- filter(worldrecords, Event=="Mens 100m", Athlete=="Usain Bolt")
q2.1[1,]$Year
class(worldrecords$Type)
q4 <- filter(worldrecords, Event=="Mens Shotput" | Event=="Womens Shotput")
q4
library(ggplot2)
q5.m <- filter(q4, Event=="Mens Shotput")
ggplot(q5.m, aes(x = Year, y = Record))+ geom_point() + labs(title="Mens Shotput")
q5.w <- filter(q4, Event=="Womens Shotput")
ggplot(q5.w, aes(x = Year, y = Record))+ geom_point() + labs(title="Womens Shotput")
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
summarise(q6.2, Avg=mean(Record))
q6.4 <- mutate(q6.2, Avg=mean(Record))
q6.5 <- filter(q6.4, Record > Avg)
summarise(q6.5, Athletes=n())
q7.m.1 <- filter(worldrecords, Event=="Mens 100m")
q7.m.2 <- group_by(q7.m.1, Athlete)
q7.m.3 <- summarize(q7.m.2, NumberOfRecords=n())
filter(q7.m.3, NumberOfRecords == max(NumberOfRecords))
q7.w.1 <- filter(worldrecords, Event=="Womens 100m")
q7.w.2 <- group_by(q7.w.1, Athlete)
q7.w.3 <- summarize(q7.w.2, NumberOfRecords=n())
filter(q7.w.3, NumberOfRecords == max(NumberOfRecords))
q8.1 <- filter(worldrecords, Event=="Mens 100m")
q8.2 <- group_by(q8.1, Nationality)
q8.3 <- summarize(q8.2, NumberOfRecords=n())
filter(q8.3, NumberOfRecords == max(NumberOfRecords))
q9.1 <- group_by(worldrecords, Event)
summarise(q9.1, Athletes=n_distinct(Athlete))
q10.1 <- group_by(worldrecords, Nationality)
q10.2 <- summarize(q10.1, NumberOfRecords=n())
filter(q10.2, NumberOfRecords == max(NumberOfRecords))
library(dplyr)
setwd("/Users/ChiYuChen/Data Analysis, Intro/Assignment 4")
worldrecords <- read.csv("WorldRecords.csv")
worldrecords
a = "\xcaUnited States"
startsWith(a, "\xa")
startsWith(a, "\xca")
sub("\xca", "", a)
a
cor(iris[,1:2])
library("foreign")
crimes.df <- read.dta("http://stats.idre.ucla.edu/stat/data/crime.dta")
rm(a)
rm(worldrecords)
help("lm")
View(crimes.df)
poverty.model <- lm(crime~poverty, data=crimes.df)
summary(poverty.model)
View(poverty.model)
pov.single.moel <- lm(crime~poverty + single, data=crimes.df)
plot(crimes.df$crime, crimes.df$poverty)
plot(crimes.df$crime, crimes.df$single)
str(crimes.df)
names(crimes.df)
head(crimes.df)
summary(crimes.df)
plot(crimes.df$crime, crimes.df$poverty)
cor(crimes.df$crime, crimes.df$poverty)
summary(poverty.model)
View(poverty.model)
help("cor")
cor(crimes.df$crime, crimes.df$poverty + crimes.df$single)
cor(crimes.df$crime, c(crimes.df$poverty, crimes.df$single))
cor(cbind(crimes.df$crime, crimes.df$poverty, crimes.df$single))
cor(cbind(crimes.df$crime, crimes.df$poverty))
new.data <- data.frame(poverty=c(8.0,12.0,12.0),single=c(10,10,20))
predict(pov.single.moel, new.data)
predict(pov.single.moel, new.data, interval="confidence")
plot(crimes.df$crime~crimes.df$poverty)
abline(poverty.model)
View(pov.single.moel)
plot(pov.single.moel)
plot(pov.single.moel)
coef(pov.single.moel)
summary(pov.single.moel)
fitted_tb <- data.frame(crimes.df, fitted.values=fitter(poverty.model), residual=resid(poverty.model))
fitted_tb <- data.frame(crimes.df, fitted.values=fitted(poverty.model), residual=resid(poverty.model))
View(fitted_tb)
q1.1 <- group_by(worldrecords, Event)
library(dplyr)
setwd("/Users/ChiYuChen/Data Analysis, Intro/Assignment 4")
worldrecords <- read.csv("WorldRecords.csv")
q1.1 <- group_by(worldrecords, Event)
nrow(summarise(q1.1))
q2.1 <- filter(worldrecords, Event=="Mens 100m", Athlete=="Usain Bolt")
q2.1[1,]$Year
class(worldrecords$Type)
q4 <- filter(worldrecords, Event=="Mens Shotput" | Event=="Womens Shotput")
q4
library(ggplot2)
q5.m <- filter(q4, Event=="Mens Shotput")
ggplot(q5.m, aes(x = Year, y = Record))+ geom_point() + labs(title="Mens Shotput")
q5.w <- filter(q4, Event=="Womens Shotput")
ggplot(q5.w, aes(x = Year, y = Record))+ geom_point() + labs(title="Womens Shotput")
q6.1 <- filter(worldrecords, Type=="time")
q6.2 <- group_by(q6.1, Event)
summarise(q6.2, Avg=mean(Record))
q6.4 <- mutate(q6.2, Avg=mean(Record))
q6.5 <- filter(q6.4, Record > Avg)
summarise(q6.5, Athletes=n())
q7.m.1 <- filter(worldrecords, Event=="Mens 100m")
q7.m.2 <- group_by(q7.m.1, Athlete)
q7.m.3 <- summarize(q7.m.2, NumberOfRecords=n())
filter(q7.m.3, NumberOfRecords == max(NumberOfRecords))
q7.w.1 <- filter(worldrecords, Event=="Womens 100m")
q7.w.2 <- group_by(q7.w.1, Athlete)
q7.w.3 <- summarize(q7.w.2, NumberOfRecords=n())
filter(q7.w.3, NumberOfRecords == max(NumberOfRecords))
q8.1 <- filter(worldrecords, Event=="Mens 100m")
q8.2 <- group_by(q8.1, Nationality)
q8.3 <- summarize(q8.2, NumberOfRecords=n())
filter(q8.3, NumberOfRecords == max(NumberOfRecords))
q9.1 <- group_by(worldrecords, Event)
summarise(q9.1, Athletes=n_distinct(Athlete))
q10.1 <- group_by(worldrecords, Nationality)
q10.2 <- summarize(q10.1, NumberOfRecords=n())
filter(q10.2, NumberOfRecords == max(NumberOfRecords))
q6.1 <- filter(worldrecords, Type=="time")
q6.1
q6.2 <- group_by(q6.1, Event)
q6.2
summarise(q6.2, Avg=mean(Record))
q6.4 <- mutate(q6.2, Avg=mean(Record))
q6.4
q6.5 <- filter(q6.4, Record > Avg)
q6.5
summarise(q6.5, Athletes=n())
